<script>
    function sendReservation()
    {
        let nameInput = $("input[name='name']");
        let surnameInput = $("input[name='surname']");
        let emailInput = $("input[name='emailAddress']");
        
        if(nameInput.is(":invalid"))
        {
            nameInput.attr("placeholder", "");
            showNotification("Prosím, vyplnte položku 'Meno'.", "warning");
            return;
        }
        
        if(surnameInput.is(":invalid"))
        {
            surnameInput.attr("placeholder", "");
            showNotification("Prosím, vyplnte položku 'Priezvisko'.", "warning");
            return;
        }
        
        if(emailInput.is(":invalid"))
        {
            showNotification("Prosím, zadajte spravnu e-mailovú adresu.", "warning");
            return;
        }
        
        let chosenSessions = "";
        
        $("input[type='radio']:checked").each(
            function (index)
            {
                if(index > 0) chosenSessions += ", ";
                chosenSessions += ($(this).attr("name") + " " + $(this).val());
            }
        );
        
        if(chosenSessions.length == 0)
        {
            showNotification("Prosím, vyberte aspoň jeden termín.", "warning");
            return;
        }
        
        let response = 
        {
            timestamp: getTimestamp(),
            name : $("input[name='name']").val(),
            surname : $("input[name='surname']").val(),
            email : $("input[name='emailAddress']").val(),
            sessions : chosenSessions
        }
        
        google.script.run
        .withFailureHandler(
            (error) =>
            {
                console.log(error.message);
                $("main").html("Termin je plny!");
            }
        )
        .onHtmlFormSubmit(response);
    }
    
    function getTimestamp()
    {
        let now = new Date();
        
        let date = now.getDate();
        let month = now.getMonth() + 1;
        let year = now.getFullYear();
        
        let hours = now.getHours();
        let minutes = now.getMinutes();
        let seconds = now.getSeconds();
        
        let timestamp =`${date}.${month}.${year} ${hours}:${minutes}:${seconds}`;
        
        return timestamp;
    }
    
    $("#sendButton").on("click", sendReservation);
    
    // $("input[type='radio']").on(
    //     "check",
    //     function(e)
    //     {
    //         if ($(this).is(':checked'))
    //         {
    //             $(this).prop('checked', false);
    //         }
    //     }
    // );
</script>